# 日本語音声認識Webアプリケーション

Web Speech APIとkuromoji.jsを使用した、リアルタイム音声認識・ひらがな変換・音声合成機能を搭載した包括的なWebアプリケーションです。

## 主要機能

- **リアルタイム音声認識**: Web Speech APIによる連続音声認識（日本語対応）
- **ひらがな変換**: kuromoji.jsの形態素解析による自動ひらがな変換
- **音声合成**: 認識テキストからの音声読み上げ機能
- **デバッグシステム**: 包括的なログ・監視機能
- **タブ管理**: 履歴とセッション管理
- **ライブ文字起こし**: リアルタイム表示対応

## アーキテクチャ

本プロジェクトは**デュアルアーキテクチャ設計**を採用しています：

### 1. モダンモジュラーアーキテクチャ（メイン版 `/`）
- クラスベース設計による関心の分離
- 専門モジュールによる機能分割
- 完全なkuromoji.js統合
- 高度なデバッグ・ログシステム

### 2. レガシー単一ファイルアーキテクチャ（テスト版）
- `/test/` および `/AddSlider/` ディレクトリ
- 単一ファイル実装（`js/WebSpeechTest.js`）
- kuromoji機能無効化（開発・テスト用）

## バージョン比較

| 機能 | メイン版 (`/`) | テスト版 (`/test/`) | AddSlider版 (`/AddSlider/`) |
|------|---------------|-------------------|------------------------|
| アーキテクチャ | モジュラー（新） | モジュラー（簡素版） | レガシー（単一ファイル） |
| kuromoji.js | 完全統合 | 無効化（スタブ） | 無効化（スタブ） |
| デバッグ機能 | 完全装備 | 基本のみ | なし |
| 音声合成 | 完全 | なし | 実験的 |

## ファイル構成

```
/
├── index.html                    # メインHTML（モジュラー版）
├── css/style.css                 # 統一スタイルシート
├── js/
│   ├── main.js                   # メインアプリケーションクラス
│   ├── speechRecognition.js      # 音声認識管理
│   ├── kuromojiManager.js        # 形態素解析管理
│   ├── textToSpeech.js          # 音声合成管理
│   ├── uiManager.js             # UI状態管理
│   ├── tabManager.js            # タブ・履歴管理
│   ├── domElements.js           # DOM要素管理
│   ├── debugLogger.js           # デバッグログ機能
│   ├── vibeLogger.js            # AI用構造化ログ
│   ├── debugUI.js               # リアルタイムデバッグUI
│   ├── kuromoji.js              # kurmojiライブラリ（ローカル）
│   └── WebSpeechTest.js         # レガシー単一ファイル実装
├── dict/                        # kuromoji辞書ファイル
├── logs/                        # デバッグログ出力
├── test/                        # テスト版（kuromoji無効）
└── AddSlider/                   # 実験版（レガシー）
```

## 開発・使用方法

### ローカル開発
```bash
# ローカル開発サーバーを開始
npm run serve

# 各バージョンのアクセス
# メイン版: http://localhost:8000/
# テスト版: http://localhost:8000/test/
# AddSlider版: http://localhost:8000/AddSlider/
```

### デバッグモード
```bash
# URLパラメータでデバッグ有効化
?debug=DEBUG&debugUI=true

# キーボードショートカット
# Ctrl+D: デバッグパネル切り替え
```

### 開発ワークフロー
1. **テスト版から開始** (`/test/`): kuromoji無しでWeb Speech API機能を分離テスト
2. **メイン版で開発** (`/`): kuromoji統合での完全機能開発
3. **AddSliderで実験** (`/AddSlider/`): 新機能のプロトタイプ作成

## ブラウザ要件

- **推奨ブラウザ**: Chrome/Chromiumベース（Web Speech API最適化）
- **マイクアクセス**: 音声認識機能に必須
- **HTTPS**: 本番環境でのマイクアクセスに必要
- **言語設定**: 日本語（`ja-JP`）音声認識

## デバッグ・ログシステム

### vibelogger統合
- **構造化ログ**: AIコードエージェント用の高度なログ機能
- **出力形式**: JSON/CSV/TXT形式で `./logs/` ディレクトリに出力
- **リアルタイム監視**: デバッグUIでのライブモニタリング

### ログレベル
- **ERROR/WARN/INFO/DEBUG/TRACE**: 5段階のログレベル
- **開発時**: DEBUGレベル推奨
- **本番前**: INFOレベルに設定

## 技術仕様

### 依存関係
- kuromoji ^0.1.2（形態素解析）
- vibelogger ^0.1.0（構造化ログ）
- Web Speech API（音声認識）
- Speech Synthesis API（音声合成）

### パフォーマンス
- kuromoji初期化: 約30秒（進捗表示付き）
- リアルタイム音声認識: 低遅延処理
- デバッグログ: 最小限のパフォーマンス影響

## 処理フロー
![6656565-1](https://github.com/user-attachments/assets/49fac104-e658-44c6-a52c-0db5e0cc4c47)

## デプロイメント

**本番デプロイ:**
- Git → GitHub Actions → さくらサーバー（自動デプロイ）
- **重要**: WinSCPでの直接アップロードは禁止
- GitHubリポジトリ経由での自動デプロイを必須とする

## 開発者向け情報

### 既知の問題
- `index.html`にGitマージコンフリクトマーカーが残存
- アーキテクチャ移行中のため、レガシーとモジュラー版が共存

### 推奨事項
- デバッグ時は必ずvibeloggerを使用
- パフォーマンス監視（特にkuromoji初期化時）
- 開発中はデバッグUIを有効化
- 新機能開発前にテスト版で基本動作確認
